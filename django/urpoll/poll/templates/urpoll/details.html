{% extends "base.html" %}
{%block content %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script> 
<script src="http://malsup.github.com/jquery.form.js"></script> 
<style>
#panel{
    padding: 5px;
    text-align: center;
    background-color: white;
    border: solid 1px #c3c3c3;
}

#panel {
    padding: 10px;
    display: none;
}
    }
  </style>
<script>  
        $(document).ready(function() {

            $('#form').ajaxForm(function() {

              $('#prblm1').hide();
              $('#prblm2').hide();
              $('#prblm3').hide();
              $('#prblm4').hide();
              $('#prblm5').hide();
              $('#panel').slideDown("slow");
                });
          });

              


       </script> 
 
<!-- Google Charts -->
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
     google.load('visualization', '1.0', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.setOnLoadCallback(drawChart);
      var A1={{ details.vote_1 }}
      var B1={{ details.vote_2 }}
      var C1={{ details.vote_3 }}
      var D1={{ details.vote_4 }}

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {

        // Create the data table.
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Topping');
        data.addColumn('number', 'Slices');
        data.addRows([
          ['A', A1],
          ['B', B1],
          ['C', C1],
          ['D', D1]
          
        ]);

        // Set chart options
        var options = {'title':"Public's polls",
                       'width':400,
                       'height':300};

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.PieChart(document.getElementById('graph'));
        chart.draw(data, options);
      }
      
       
    </script>
<!-- Google chart ends -->
{% if reasons %}
<h1>{{ reasons }}</h1>
{% endif %}
{% if details %}
<h2>{{ details.question }} </h2>
<div class="message"></div>
<div class="toggle_container">
<div class="block">
 <form  action="{% url 'submit_form' details.id %}" method="POST" id="form">
{% csrf_token %}
<table style="width:100%">
  <tr>
<td><label>A:</label><input type="radio" name="choice" id="prblm1" onclick="radioclick(this.value)"  value="1" /><label>{{ details.option1 }}</label></td>
<td><label>B:</label><input type="radio" name="choice" id="prblm2" onclick="radioclick(this.value)"  value="2" /><label>{{ details.option2}}</label></td>
</tr>
<tr>
<td><label>C:</label><input type="radio" name="choice" id="prblm3" onclick="radioclick(this.value)"  value="3" /><label>{{ details.option3 }}</label></td>
<td><label>D:</label><input type="radio" name="choice" id="prblm4" onclick="radioclick(this.value)"  value="4" /><label>{{ details.option4 }}</label></td>
</tr>
</table>
<input type="submit" value="Vote" id="prblm5" />
</form>      

</div>
</div>
<script>
function radioclick(val)
{
  document.getElementById("result").value=val;
  if(val==1)
  {
    $("#test1").html("Why  A  ? ");
  }
  if(val==2)
  {
    $("#test1").html("Why  B  ? ");
  }
  if(val==3)
  {
    $("#test1").html("Why  C  ? ");
  }
  if(val==4)
  {
    $("#test1").html("Why D ? ");
  }
}
/*$('#form2').submit(function(e)
              {
                $('#panel').html('<img src="http://preloaders.net/preloaders/287/Filling%20broken%20ring.gif"> ');
                $.ajax({
                  url:$(this).attr("action"),
                  data:$(this).serializeArray(),
                  type:"POST",
                  success:function(d)
                  {
                    $('#panel').slideUp("slow");
                  }
                });
                e.preventDefault();
                e.unbind();

                });*/

 $(document).ready(function() {

            $('#form2').ajaxForm(function() {
              $('#panel').slideUp("slow");
                });
          });


</script>
<div id="panel" >  
<h2 id="test1"></h2> 
<form action="{% url 'reason_opt' details.id %}" method="POST" id="form2">
  {% csrf_token %}
<input type="hidden"  id="result" name="ans" />

<textarea rows="4" cols="50" name="test" ></textarea>
<br>
<input type="Submit" name="Submit">
</form>
</div>
<script>
$(document).ready(function()
{
  $('#spinner').hide();
  /* clicking A */
$('#opt1').click(function()
{
$('#results').html( '&nbsp;').load('{% url 'get_comments_A' details.id %}');
});
 /* Clicking B */
 $('#opt2').click(function()
{
$('#results').html( '&nbsp;').load('{% url 'get_comments_B' details.id %}');
});

$('#opt3').click(function()
{
$('#results').html( '&nbsp;').load('{% url 'get_comments_C' details.id %}');
});

$('#opt4').click(function()
{
$('#results').html( '&nbsp;').load('{% url 'get_comments_D' details.id %}');
});

$(document).ajaxStart(function()
{
  $('#spinner').show();
}).ajaxStop(function()
{
  $('#spinner').hide();
})
});
</script>

<div id="graph"></div>
<div id="topnav">
  <ul id="topnavlist">
    <li><a class="active" id="opt1"> A</a></li>
    <li><a  id="opt2">B</a></li>
    <li><a   id="opt3">C</a></li>

    <li><a  id="opt4">D</a></li>


  </ul>
</div>
<div align="center">
<span id="spinner"><img src="{{ STATIC_URL }}spinner.gif" align="middle" /></span>
</div>
<div id="results">

  <div>

{% endif %}      
{% endblock %}



<!-- Sidebar -->


